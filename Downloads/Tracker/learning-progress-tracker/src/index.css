@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --background: 0 0% 100%;
    --foreground: 222.2 95% 4.9%; /* Noir plus intense */

    --muted: 210 40% 96.1%;
    --muted-foreground: 215.4 16.3% 46.9%;

    --popover: 0 0% 100%;
    --popover-foreground: 222.2 95% 4.9%;

    --card: 0 0% 100%;
    --card-foreground: 222.2 95% 4.9%; /* Darker text for better visibility */

    --border: 214.3 31.8% 91.4%;
    --input: 214.3 31.8% 91.4%;

    --primary: 222.2 47.4% 11.2%;
    --primary-foreground: 210 40% 98%;

    --secondary: 210 40% 96.1%;
    --secondary-foreground: 222.2 47.4% 11.2%;

    --accent: 210 40% 96.1%;
    --accent-foreground: 222.2 47.4% 11.2%;

    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 210 40% 98%;

    --ring: 215 20.2% 65.1%;

    --radius: 0.5rem;
  }

  .dark {
    --background: 222.2 47.4% 11.2%;
    --foreground: 210 40% 98%;

    --muted: 217.2 32.6% 17.5%;
    --muted-foreground: 215 20.2% 65.1%;

    --popover: 222.2 47.4% 11.2%;
    --popover-foreground: 210 40% 98%;

    --card: 222.2 47.4% 11.2%;
    --card-foreground: 210 40% 98%;

    --border: 217.2 32.6% 17.5%;
    --input: 217.2 32.6% 17.5%;

    --primary: 210 40% 98%;
    --primary-foreground: 222.2 47.4% 11.2%;

    --secondary: 217.2 32.6% 17.5%;
    --secondary-foreground: 210 40% 98%;

    --accent: 217.2 32.6% 17.5%;
    --accent-foreground: 210 40% 98%;

    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 0 85.7% 97.3%;

    --ring: 217.2 32.6% 17.5%;
  }
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground; 
    font-family: 'Inter', system-ui, -apple-system, sans-serif; /* Police par défaut */
  }
  
  /* Ensure proper text contrast in light mode */
  .light {
    color-scheme: light;
  }
  
  /* Ensure proper text contrast in dark mode */
  .dark {
    color-scheme: dark;
  }
}

/* Editor styles */
.ProseMirror {
  > * + * {
    margin-top: 0.75em;
  }

  ul,
  ol {
    padding: 0 1rem;
    @apply text-foreground; /* Use theme colors instead of hardcoded black */
  }

  code {
    background-color: rgba(97, 97, 97, 0.1);
    border-radius: 0.25em;
    padding: 0.15em 0.3em;
    font-family: monospace;
  }

  pre {
    background: #0d0d0d;
    border-radius: 0.5rem;
    color: #fff;
    font-family: monospace;
    padding: 0.75rem 1rem;

    code {
      background: none;
      color: inherit;
      font-size: 0.8rem;
      padding: 0;
    }
  }

  mark {
    background-color: #faf594;
  }

  img {
    height: auto;
    max-width: 100%;
  }

  hr {
    margin: 1rem 0;
  }

  blockquote {
    border-left: 2px solid rgba(13, 13, 13, 0.1);
    padding-left: 1rem;
  }

  hr {
    border: none;
    border-top: 2px solid rgba(13, 13, 13, 0.1);
    margin: 2rem 0;
  }

  ul[data-type="taskList"] {
    list-style: none;
    padding: 0;

    li {
      display: flex;
      gap: 0.5rem;
      align-items: flex-start;

      > label {
        margin-right: 0.5rem;
        user-select: none;
      }

      > div {
        flex: 1;
      }
    }
  }

  /* Text size styles */
  .text-size-large {
    font-size: 1.5rem;
    line-height: 2rem;
  }

  .text-size-medium {
    font-size: 1.25rem;
    line-height: 1.75rem;
  }

  .text-size-normal {
    font-size: 1rem;
    line-height: 1.5rem;
  }
}

.pomodoro-settings {
  @apply text-foreground dark:text-white; /* Use theme colors */
}

body {
  font-family: 'Inter', system-ui, -apple-system, sans-serif;
}

/* Styles for code blocks in content */
code {
  @apply bg-gray-100 dark:bg-gray-800 text-foreground dark:text-gray-200;
  padding: 0.2em 0.4em;
  border-radius: 4px;
  font-family: monospace;
}

pre {
  @apply bg-gray-100 dark:bg-gray-800 text-foreground dark:text-gray-200;
  padding: 1em;
  border-radius: 4px;
  overflow: auto;
  font-family: monospace;
}

/* Fix for mobile light mode */
@media (max-width: 768px) {
  /* GARANTIR UN MODE CLAIR CORRECT */
  :root:not(.dark) body {
    background-color: white !important;
  }
  
  :root:not(.dark) [class*="dashboard"],
  :root:not(.dark) [id*="dashboard"] {
    background-color: white !important;
  }
  
  :root:not(.dark) .card,
  :root:not(.dark) [class*="card"] {
    background-color: white !important;
    border-color: #e2e8f0 !important;
  }
  
  /* Remise à zéro des styles de texte en mode clair */
  :root:not(.dark) p, 
  :root:not(.dark) h1, 
  :root:not(.dark) h2, 
  :root:not(.dark) h3,
  :root:not(.dark) h4,
  :root:not(.dark) span,
  :root:not(.dark) div {
    color: #0f172a !important; /* slate-900 */
  }
  
  /* Texte secondaire plus clair */
  :root:not(.dark) [class*="text-gray-"],
  :root:not(.dark) [class*="text-muted"],
  :root:not(.dark) [class*="secondary"] {
    color: #64748b !important; /* slate-500 */
  }
  
  /* Ensure text is visible in light mode */
  :root:not(.dark) button, 
  :root:not(.dark) input, 
  :root:not(.dark) textarea, 
  :root:not(.dark) select,
  :root:not(.dark) label {
    @apply text-foreground;
  }
}

/* Fix for dark mode consistency */
.dark .bg-white {
  @apply bg-gray-800;
}

.dark .text-black {
  @apply text-white;
}

/* Ensure proper contrast for all UI elements */
.dark input::placeholder,
.dark textarea::placeholder {
  @apply text-gray-400;
}

:root:not(.dark) input::placeholder,
:root:not(.dark) textarea::placeholder {
  @apply text-gray-500;
}

/* 
 * CORRECTION CRITIQUE DES ICÔNES EN MODE SOMBRE SUR MOBILE 
 * Ces règles sont ajoutées à la fin du fichier pour avoir la priorité maximale
 * Mais maintenant elles ciblent UNIQUEMENT le mode sombre
 */
@media (max-width: 768px) {
  /* Règles générales pour SVG en mode sombre uniquement */
  html.dark svg {
    fill: none !important;
    stroke-width: 2px !important;
  }
  
  /* CORRECTION DASHBOARD ET ICÔNES - MODE SOMBRE UNIQUEMENT */
  html.dark [class*="dashboard"] svg.lucide-calendar,
  html.dark [class*="dashboard"] .calendar-icon,
  html.dark [class*="calendar-button"] svg {
    color: #60a5fa !important;
    stroke: #60a5fa !important;
    fill: none !important;
  }
  
  html.dark [class*="dashboard"] svg.lucide-target,
  html.dark [class*="dashboard"] .target-icon,
  html.dark [class*="goals-button"] svg {
    color: #34d399 !important;
    stroke: #34d399 !important;
    fill: none !important;
  }
  
  html.dark [class*="dashboard"] svg.lucide-clock,
  html.dark [class*="dashboard"] .clock-icon {
    color: #60a5fa !important;
    stroke: #60a5fa !important;
    fill: none !important;
  }
  
  html.dark [class*="dashboard"] svg.lucide-check-circle,
  html.dark [class*="dashboard"] svg.lucide-check-circle-2,
  html.dark [class*="dashboard"] .tasks-icon {
    color: #34d399 !important;
    stroke: #34d399 !important;
    fill: none !important;
  }
  
  html.dark [class*="dashboard"] svg.lucide-book-open,
  html.dark [class*="dashboard"] .book-icon {
    color: #a78bfa !important;
    stroke: #a78bfa !important;
    fill: none !important;
  }
  
  html.dark [class*="dashboard"] svg.lucide-trophy,
  html.dark [class*="dashboard"] .trophy-icon {
    color: #fbbf24 !important;
    stroke: #fbbf24 !important;
    fill: none !important;
  }
  
  /* Icônes dans les cartes statistiques - MODE SOMBRE UNIQUEMENT */
  html.dark .from-blue-50 svg,
  html.dark [class*="from-blue-50"] svg,
  html.dark .bg-blue-100 svg,
  html.dark [class*="bg-blue-100"] svg {
    color: #60a5fa !important;
    stroke: #60a5fa !important;
    fill: none !important;
  }
  
  html.dark .from-green-50 svg,
  html.dark [class*="from-green-50"] svg,
  html.dark .bg-green-100 svg,
  html.dark [class*="bg-green-100"] svg {
    color: #34d399 !important;
    stroke: #34d399 !important;
    fill: none !important;
  }
  
  html.dark .from-purple-50 svg,
  html.dark [class*="from-purple-50"] svg,
  html.dark .bg-purple-100 svg,
  html.dark [class*="bg-purple-100"] svg {
    color: #a78bfa !important;
    stroke: #a78bfa !important;
    fill: none !important;
  }
  
  html.dark .from-amber-50 svg,
  html.dark [class*="from-amber-50"] svg,
  html.dark .bg-amber-100 svg,
  html.dark [class*="bg-amber-100"] svg {
    color: #fbbf24 !important;
    stroke: #fbbf24 !important;
    fill: none !important;
  }
  
  /* Fonds colorés pour les icônes - MODE SOMBRE UNIQUEMENT */
  html.dark .bg-blue-100,
  html.dark [class*="bg-blue-100"] {
    background-color: #1e3a8a !important; /* blue-900 */
  }
  
  html.dark .bg-green-100,
  html.dark [class*="bg-green-100"] {
    background-color: #065f46 !important; /* emerald-900 */
  }
  
  html.dark .bg-purple-100,
  html.dark [class*="bg-purple-100"] {
    background-color: #4c1d95 !important; /* purple-900 */
  }
  
  html.dark .bg-amber-100,
  html.dark [class*="bg-amber-100"] {
    background-color: #92400e !important; /* amber-900 */
  }
  
  /* Cartes statistiques en mode sombre - MODE SOMBRE UNIQUEMENT */
  html.dark .from-blue-50,
  html.dark [class*="from-blue-50"] {
    background: linear-gradient(135deg, #172554 0%, #1e3a8a 100%) !important;
    border-color: #1d4ed8 !important;
  }
  
  html.dark .from-green-50,
  html.dark [class*="from-green-50"] {
    background: linear-gradient(135deg, #064e3b 0%, #065f46 100%) !important;
    border-color: #059669 !important;
  }
  
  html.dark .from-purple-50,
  html.dark [class*="from-purple-50"] {
    background: linear-gradient(135deg, #2e1065 0%, #4c1d95 100%) !important;
    border-color: #7e22ce !important;
  }
  
  html.dark .from-amber-50,
  html.dark [class*="from-amber-50"] {
    background: linear-gradient(135deg, #451a03 0%, #78350f 100%) !important;
    border-color: #b45309 !important;
  }
  
  /* CORRECTIONS POUR LE MODE CLAIR - Garantir les couleurs d'icônes et de fonds */
  :root:not(.dark) svg {
    fill: none;
    stroke-width: 1.5;
  }
  
  /* Calendar - Bleu */
  :root:not(.dark) svg.lucide-calendar {
    color: #3b82f6 !important; /* blue-500 */
    stroke: #3b82f6 !important;
  }
  
  /* Target/Goals - Vert */
  :root:not(.dark) svg.lucide-target {
    color: #10b981 !important; /* emerald-500 */
    stroke: #10b981 !important;
  }
  
  /* Clock - Bleu */
  :root:not(.dark) svg.lucide-clock {
    color: #3b82f6 !important; /* blue-500 */
    stroke: #3b82f6 !important;
  }
  
  /* Check/Completed - Vert */
  :root:not(.dark) svg.lucide-check-circle,
  :root:not(.dark) svg.lucide-check-circle-2 {
    color: #10b981 !important; /* emerald-500 */
    stroke: #10b981 !important;
  }
  
  /* BookOpen - Violet */
  :root:not(.dark) svg.lucide-book-open {
    color: #8b5cf6 !important; /* violet-500 */
    stroke: #8b5cf6 !important;
  }
  
  /* Trophy - Ambre */
  :root:not(.dark) svg.lucide-trophy {
    color: #f59e0b !important; /* amber-500 */
    stroke: #f59e0b !important;
  }
  
  /* CARTES STATISTIQUES AVEC FONDS COLORÉS - MODE CLAIR */
  /* Carte bleue */
  :root:not(.dark) .from-blue-50,
  :root:not(.dark) [class*="from-blue-50"] {
    background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%) !important; /* blue-50 à blue-100 */
    border-color: #bfdbfe !important; /* blue-200 */
  }
  
  /* Carte verte */
  :root:not(.dark) .from-green-50,
  :root:not(.dark) [class*="from-green-50"] {
    background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%) !important; /* green-50 à green-100 */
    border-color: #a7f3d0 !important; /* green-200 */
  }
  
  /* Carte violette */
  :root:not(.dark) .from-purple-50,
  :root:not(.dark) [class*="from-purple-50"] {
    background: linear-gradient(135deg, #f5f3ff 0%, #ede9fe 100%) !important; /* purple-50 à purple-100 */
    border-color: #ddd6fe !important; /* purple-200 */
  }
  
  /* Carte ambre */
  :root:not(.dark) .from-amber-50,
  :root:not(.dark) [class*="from-amber-50"] {
    background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%) !important; /* amber-50 à amber-100 */
    border-color: #fde68a !important; /* amber-200 */
  }
  
  /* FONDS CIRCULAIRES DES ICÔNES - MODE CLAIR */
  /* Fond bleu pour icône */
  :root:not(.dark) .bg-blue-100,
  :root:not(.dark) [class*="bg-blue-100"] {
    background-color: #dbeafe !important; /* blue-100 */
    color: #3b82f6 !important; /* blue-500 */
  }
  
  /* Fond vert pour icône */
  :root:not(.dark) .bg-green-100,
  :root:not(.dark) [class*="bg-green-100"] {
    background-color: #d1fae5 !important; /* green-100 */
    color: #10b981 !important; /* emerald-500 */
  }
  
  /* Fond violet pour icône */
  :root:not(.dark) .bg-purple-100,
  :root:not(.dark) [class*="bg-purple-100"] {
    background-color: #ede9fe !important; /* purple-100 */
    color: #8b5cf6 !important; /* violet-500 */
  }
  
  /* Fond ambre pour icône */
  :root:not(.dark) .bg-amber-100,
  :root:not(.dark) [class*="bg-amber-100"] {
    background-color: #fef3c7 !important; /* amber-100 */
    color: #f59e0b !important; /* amber-500 */
  }
}