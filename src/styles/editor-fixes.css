/* CORRECTIFS POUR L'ÉDITEUR DE TEXTE */

/* Styles pour améliorer la visibilité du texte en gras */
strong, 
b,
.font-bold,
.font-semibold,
.font-extrabold,
[style*="font-weight: bold"],
[style*="font-weight:bold"],
[style*="font-weight: 700"],
[style*="font-weight:700"],
[style*="font-weight: 900"],
[style*="font-weight:900"] {
  font-weight: 900 !important;
}

/* Styles spécifiques pour le mode clair (problème principal) */
@media (max-width: 768px) {
  html[data-theme="light"] strong,
  html[data-theme="light"] b,
  html[data-theme="light"] .font-bold,
  html[data-theme="light"] .font-semibold,
  html[data-theme="light"] .font-extrabold,
  html[data-theme="light"] [style*="font-weight: bold"],
  html[data-theme="light"] [style*="font-weight:bold"],
  html[data-theme="light"] [style*="font-weight: 700"],
  html[data-theme="light"] [style*="font-weight:700"],
  html[data-theme="light"] .ProseMirror strong,
  html[data-theme="light"] .ProseMirror b,
  html[data-theme="light"] [class*="ProseMirror"] strong,
  html[data-theme="light"] [class*="ProseMirror"] b,
  html[data-theme="light"] [contenteditable="true"] strong,
  html[data-theme="light"] [contenteditable="true"] b,
  html[data-theme="light"] .tiptap strong,
  html[data-theme="light"] .tiptap b {
    font-weight: 900 !important;
    color: #000000 !important;
    text-shadow: 0 0 0.5px rgba(0, 0, 0, 0.3) !important;
    background-color: rgba(255, 255, 0, 0.15) !important;
    padding: 0 2px !important;
    border-radius: 2px !important;
  }

  /* Amélioration du bouton de gras pour le rendre plus visible lorsqu'il est actif */
  html[data-theme="light"] .mobile-bold-button.active,
  html[data-theme="light"] [class*="mobile-bold-button"].active {
    background-color: rgba(59, 130, 246, 0.3) !important;
    color: #1d4ed8 !important;
    font-weight: 700 !important;
    border-radius: 4px !important;
    box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.3) !important;
  }
}

/* CORRECTIFS SUPPLÉMENTAIRES POUR LES GUILLEMETS ET LES COULEURS DE TEXTE */
/* Ce code garantit l'affichage correct sur mobile en mode clair */

/* Style pour le picker de couleur et ses boutons */
.mobile-color-button {
  position: relative !important;
}

.mobile-color-button:active,
.mobile-color-button.active {
  background-color: rgba(59, 130, 246, 0.3) !important;
}

.mobile-color-option {
  position: relative !important;
  overflow: hidden !important;
  transition: transform 0.2s ease-in-out !important;
}

.mobile-color-option:active {
  transform: scale(1.2) !important;
}

/* Assurer la visibilité correcte du texte coloré */
@media (max-width: 768px) {
  html[data-theme="light"] [style*="color:"],
  html[data-theme="light"] [data-color] {
    text-shadow: 0 0 0.5px rgba(0, 0, 0, 0.2) !important;
    box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.1) !important;
  }
  
  /* Traitement spécial pour les guillemets simples */
  html[data-theme="light"] .ProseMirror,
  html[data-theme="light"] .tiptap,
  html[data-theme="light"] [contenteditable="true"] {
    font-variant-ligatures: none !important; /* Désactiver les ligatures pour éviter des problèmes d'affichage */
    word-break: break-word !important;
    overflow-wrap: break-word !important;
  }
  
  /* Style spécial pour s'assurer que les codes avec guillemets sont visibles */
  html[data-theme="light"] .ProseMirror code,
  html[data-theme="light"] .tiptap code,
  html[data-theme="light"] [contenteditable="true"] code {
    background: rgba(0, 0, 0, 0.05) !important;
    border: 1px solid rgba(0, 0, 0, 0.1) !important; 
    color: #000000 !important;
    font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace !important;
    padding: 0.2em 0.4em !important;
    border-radius: 3px !important;
    font-size: 90% !important;
  }
  
  /* Assurer la visibilité des éléments qui contiennent souvent des guillemets simples */
  html[data-theme="light"] .ProseMirror *, 
  html[data-theme="light"] .tiptap *,
  html[data-theme="light"] [contenteditable="true"] * {
    color: #000000 !important;
  }
  
  /* Force la visibilité des textes colorés */
  html[data-theme="light"] .ProseMirror [style*="color:"] *,
  html[data-theme="light"] .tiptap [style*="color:"] *,
  html[data-theme="light"] [contenteditable="true"] [style*="color:"] * {
    color: inherit !important;
  }
}

/* Renforcement de la visibilité des guillemets simples */
@supports (-webkit-overflow-scrolling: touch) {
  /* Correctifs spécifiques pour iOS */
  .ProseMirror code,
  .tiptap code,
  [contenteditable="true"] code {
    font-family: "SFMono-Regular", Consolas, Menlo, monospace !important;
    -webkit-font-smoothing: antialiased !important;
  }
}

/* CORRECTIFS PRIORITAIRES POUR LES COULEURS DE TEXTE DANS L'ÉDITEUR */
/* Ces règles sont spécifiques à l'interface d'édition */

/* Règles de base pour tous les sélecteurs de couleur */
.mobile-color-button,
.color-button,
[class*="color-button"] {
  position: relative !important;
}

.mobile-color-button:active,
.mobile-color-button.active,
.color-button:active,
.color-button.active {
  background-color: rgba(59, 130, 246, 0.3) !important;
}

.mobile-color-option,
.color-option,
[class*="color-option"] {
  position: relative !important;
  overflow: hidden !important;
  transition: transform 0.2s ease-in-out !important;
  border: 1px solid rgba(0, 0, 0, 0.2) !important;
}

.mobile-color-option:active,
.mobile-color-option:hover,
.color-option:active,
.color-option:hover {
  transform: scale(1.25) !important;
  border-color: rgba(59, 130, 246, 0.5) !important;
  z-index: 10 !important;
  box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2) !important;
}

/* Renforcer les couleurs dans le contenu de l'éditeur */
.ProseMirror [style*="color:"],
.ProseMirror [data-color],
.tiptap [style*="color:"],
.tiptap [data-color],
[contenteditable="true"] [style*="color:"],
[contenteditable="true"] [data-color] {
  color: attr(style) !important;
  color: attr(data-color) !important;
}

/* Forcer l'application des couleurs de base courantes */
.ProseMirror [style*="color: red"],
.ProseMirror [style*="color:red"],
.tiptap [style*="color: red"],
.tiptap [style*="color:red"] {
  color: #f00 !important;
}

.ProseMirror [style*="color: blue"],
.ProseMirror [style*="color:blue"],
.tiptap [style*="color: blue"],
.tiptap [style*="color:blue"] {
  color: #00f !important;
}

.ProseMirror [style*="color: green"],
.ProseMirror [style*="color:green"],
.tiptap [style*="color: green"],
.tiptap [style*="color:green"] {
  color: #0a0 !important;
}

.ProseMirror [style*="color: yellow"],
.ProseMirror [style*="color:yellow"],
.tiptap [style*="color: yellow"],
.tiptap [style*="color:yellow"] {
  color: #aa0 !important;
}

/* Améliorations pour les textes colorés dans différents contextes */
.text-color-custom,
.colored-text {
  position: relative !important;
  display: inline !important;
}

/* Classes spécifiques pour chaque couleur de texte courante */
.text-color-ff0000,
[data-color="#ff0000"] {
  color: #f00 !important;
}

.text-color-0000ff,
[data-color="#0000ff"] {
  color: #00f !important;
}

.text-color-00ff00,
[data-color="#00ff00"] {
  color: #0c0 !important;
}

.text-color-ffff00,
[data-color="#ffff00"] {
  color: #cc0 !important;
}

/* Correctifs pour le mode sombre */
html[data-theme="dark"] .text-color-ff0000,
html[data-theme="dark"] [data-color="#ff0000"] {
  color: #f66 !important;
}

html[data-theme="dark"] .text-color-0000ff,
html[data-theme="dark"] [data-color="#0000ff"] {
  color: #66f !important;
}

html[data-theme="dark"] .text-color-00ff00,
html[data-theme="dark"] [data-color="#00ff00"] {
  color: #6f6 !important;
}

html[data-theme="dark"] .text-color-ffff00,
html[data-theme="dark"] [data-color="#ffff00"] {
  color: #ff6 !important;
}

/* Correctifs spécifiques pour les appareils mobiles */
@media (max-width: 768px) {
  .ProseMirror [style*="color:"],
  .ProseMirror [data-color],
  .tiptap [style*="color:"],
  .tiptap [data-color],
  [contenteditable="true"] [style*="color:"],
  [contenteditable="true"] [data-color] {
    display: inline-block !important;
    padding: 0 1px !important;
    border-radius: 2px !important;
    background-color: rgba(255, 255, 255, 0.1) !important;
  }
  
  html[data-theme="light"] .ProseMirror [style*="color:"],
  html[data-theme="light"] .ProseMirror [data-color],
  html[data-theme="light"] .tiptap [style*="color:"],
  html[data-theme="light"] .tiptap [data-color],
  html[data-theme="light"] [contenteditable="true"] [style*="color:"],
  html[data-theme="light"] [contenteditable="true"] [data-color] {
    background-color: rgba(255, 255, 255, 0.8) !important;
    box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.1) !important;
  }
  
  html[data-theme="dark"] .ProseMirror [style*="color:"],
  html[data-theme="dark"] .ProseMirror [data-color],
  html[data-theme="dark"] .tiptap [style*="color:"],
  html[data-theme="dark"] .tiptap [data-color],
  html[data-theme="dark"] [contenteditable="true"] [style*="color:"],
  html[data-theme="dark"] [contenteditable="true"] [data-color] {
    background-color: rgba(0, 0, 0, 0.3) !important;
    box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.1) !important;
  }
}

/* Styles pour les éléments avec attribut de couleur - remplace HTMLAttributes */
.ProseMirror [style*="color:"],
.tiptap [style*="color:"],
[contenteditable="true"] [style*="color:"] {
  /* Ces styles remplacent l'attribut class 'text-color-custom' que nous voulions ajouter */
  display: inline !important;
  position: relative !important;
  /* Ajoutez d'autres styles selon vos besoins */
}

/* Styles spécifiques pour les appareils mobiles */
@media (max-width: 768px) {
  .ProseMirror [style*="color:"],
  .tiptap [style*="color:"],
  [contenteditable="true"] [style*="color:"] {
    padding: 0 1px !important;
    border-radius: 2px !important;
  }
  
  /* Version mode clair */
  html[data-theme="light"] .ProseMirror [style*="color:"],
  html[data-theme="light"] .tiptap [style*="color:"],
  html[data-theme="light"] [contenteditable="true"] [style*="color:"] {
    background-color: rgba(255, 255, 255, 0.8) !important;
    box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.05) !important;
  }
  
  /* Version mode sombre */
  html[data-theme="dark"] .ProseMirror [style*="color:"],
  html[data-theme="dark"] .tiptap [style*="color:"],
  html[data-theme="dark"] [contenteditable="true"] [style*="color:"] {
    background-color: rgba(0, 0, 0, 0.2) !important;
    box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.05) !important;
  }
}

/* CORRECTIFS VITAUX POUR IOS ET SAFARI */
@media not all and (min-resolution:.001dpcm) { 
  @supports (-webkit-appearance:none) {
    .ProseMirror [style*="color:"],
    .tiptap [style*="color:"],
    [contenteditable="true"] [style*="color:"] {
      display: inline-block !important;
      -webkit-box-decoration-break: clone !important;
      box-decoration-break: clone !important;
    }
  }
}
