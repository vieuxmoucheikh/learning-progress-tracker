/* Synchronisation des thèmes pour transitions fluides et cohérence visuelle */

/* Forcer l'application immédiate du mode clair/sombre sans délai */
html {
  transition: background-color 0.1s ease-out;
}

/* Styles de base pour le système de gestion des thèmes */
html[data-theme="light"] {
  color-scheme: light;
}

html[data-theme="dark"] {
  color-scheme: dark;
}

/* Éviter le flash pendant la transition de thèmes */
html.theme-transitioning * {
  transition: none !important;
}

/* Amélioration des styles pour les icônes et textes */
html[data-theme="light"] {
  --card-bg: 255 255 255;
  --card-border: 226 232 240;
  --card-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
  
  /* Textes */
  --text-heading: 222 95 18;
  --text-body: 51 65 85;
  --text-muted: 100 116 139;
  
  /* Iconographie */
  --icon-primary: 37 99 235;
  --icon-success: 16 185 129;
  --icon-warning: 245 158 11;
  --icon-danger: 220 38 38;
  --icon-info: 59 130 246;
  --icon-muted: 100 116 139;
  
  /* Badges et boutons */
  --badge-bg-blue: 239 246 255;
  --badge-text-blue: 30 64 175;
  --badge-bg-green: 236 253 245;
  --badge-text-green: 5 150 105;
  --badge-bg-yellow: 254 249 195;
  --badge-text-yellow: 202 138 4;
  --badge-bg-red: 254 226 226;
  --badge-text-red: 185 28 28;
  
  /* Boutons */
  --button-primary-bg: 37 99 235;
  --button-primary-text: 255 255 255;
  --button-secondary-bg: 241 245 249;
  --button-secondary-text: 15 23 42;
  --button-danger-bg: 220 38 38;
  --button-danger-text: 255 255 255;
}

html[data-theme="dark"] {
  --card-bg: 30 41 59;
  --card-border: 51 65 85;
  --card-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
  
  /* Textes */
  --text-heading: 248 250 252;
  --text-body: 226 232 240;
  --text-muted: 148 163 184;
  
  /* Iconographie */
  --icon-primary: 96 165 250;
  --icon-success: 52 211 153;
  --icon-warning: 251 191 36;
  --icon-danger: 248 113 113;
  --icon-info: 96 165 250;
  --icon-muted: 148 163 184;
  
  /* Badges et boutons */
  --badge-bg-blue: rgba(59, 130, 246, 0.2);
  --badge-text-blue: 147 197 253;
  --badge-bg-green: rgba(16, 185, 129, 0.2);
  --badge-text-green: 110 231 183;
  --badge-bg-yellow: rgba(245, 158, 11, 0.2);
  --badge-text-yellow: 253 224 71;
  --badge-bg-red: rgba(220, 38, 38, 0.2);
  --badge-text-red: 252 165 165;
  
  /* Boutons */
  --button-primary-bg: 59 130 246;
  --button-primary-text: 255 255 255;
  --button-secondary-bg: 51 65 85;
  --button-secondary-text: 226 232 240;
  --button-danger-bg: 220 38 38;
  --button-danger-text: 255 255 255;
}

/* Appliquer les styles de base aux composants */
.card {
  background-color: rgb(var(--card-bg));
  border-color: rgb(var(--card-border));
  box-shadow: var(--card-shadow);
}

h1, h2, h3, h4, h5, h6 {
  color: rgb(var(--text-heading));
}

p, span:not([class*="text-"]), div:not([class*="text-"]) {
  color: rgb(var(--text-body));
}

.text-muted, [class*="text-muted"] {
  color: rgb(var(--text-muted));
}

/* Icones par type */
svg.lucide-check, svg.lucide-check-circle, [class*="success"] svg {
  color: rgb(var(--icon-success)) !important;
}

svg.lucide-alert-circle, svg.lucide-alert-triangle, [class*="warning"] svg {
  color: rgb(var(--icon-warning)) !important;
}

svg.lucide-x, svg.lucide-x-circle, [class*="danger"] svg {
  color: rgb(var(--icon-danger)) !important;
}

svg.lucide-info, [class*="info"] svg {
  color: rgb(var(--icon-info)) !important;
}

/* Badges */
.badge.bg-blue-100, .badge.dark\:bg-blue-800\/30 {
  background-color: rgb(var(--badge-bg-blue));
  color: rgb(var(--badge-text-blue));
}

.badge.bg-green-100, .badge.dark\:bg-green-800\/30 {
  background-color: rgb(var(--badge-bg-green));
  color: rgb(var(--badge-text-green));
}

.badge.bg-yellow-100, .badge.dark\:bg-yellow-800\/30 {
  background-color: rgb(var(--badge-bg-yellow));
  color: rgb(var(--badge-text-yellow));
}

.badge.bg-red-100, .badge.dark\:bg-red-800\/30 {
  background-color: rgb(var(--badge-bg-red));
  color: rgb(var(--badge-text-red));
}

/* Styles pour assurer une transition fluide entre les thèmes */

/* Désactiver les transitions pendant le changement de thème pour éviter les scintillements */
.theme-transitioning,
.theme-transitioning * {
  transition: none !important;
}

/* S'assurer que les attributs data-theme et class sont synchronisés */
html[data-theme="dark"] {
  color-scheme: dark;
}

html[data-theme="light"] {
  color-scheme: light;
}

/* Force d'application pour résoudre les problèmes de styles persistants */
html[data-theme="dark"] body,
html.dark body {
  background-color: #0f172a !important;
  color: #f8fafc !important;
}

html[data-theme="light"] body,
html:not(.dark) body {
  background-color: #ffffff !important;
  color: #0f172a !important;
}

/* Réinitialisation des styles spécifiques qui peuvent persister lors du changement de thème */
html[data-theme="dark"] .bg-white,
html.dark .bg-white {
  background-color: #1e293b !important; /* slate-800 */
}

html[data-theme="light"] .bg-gray-800,
html:not(.dark) .bg-gray-800 {
  background-color: #ffffff !important;
}

/* Correction pour les cartes d'apprentissage */

/* Restaurer les bordures des cartes */
@media (max-width: 768px) {
  /* Cartes principales en mode clair */
  html[data-theme="light"] .learning-item-card .card {
    border: 3px solid #e2e8f0 !important;
    border-radius: 16px !important;
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1) !important;
    margin-bottom: 32px !important;
    background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%) !important;
  }
  
  /* Bordures colorées selon le statut */
  html[data-theme="light"] .learning-item-card .card[class*="border-l-blue-400"],
  html[data-theme="light"] .learning-item-card .card[class*="status-in_progress"] {
    border-left: 8px solid #3b82f6 !important; /* blue-500 */
    border-right: 3px solid #e2e8f0 !important;
    border-top: 3px solid #e2e8f0 !important;
    border-bottom: 3px solid #e2e8f0 !important;
  }

  html[data-theme="light"] .learning-item-card .card[class*="border-l-green-400"],
  html[data-theme="light"] .learning-item-card .card[class*="status-completed"] {
    border-left: 8px solid #10b981 !important; /* emerald-500 */
    border-right: 3px solid #e2e8f0 !important;
    border-top: 3px solid #e2e8f0 !important;
    border-bottom: 3px solid #e2e8f0 !important;
  }

  html[data-theme="light"] .learning-item-card .card[class*="border-l-yellow-400"],
  html[data-theme="light"] .learning-item-card .card[class*="status-on_hold"] {
    border-left: 8px solid #f59e0b !important; /* amber-500 */
    border-right: 3px solid #e2e8f0 !important;
    border-top: 3px solid #e2e8f0 !important;
    border-bottom: 3px solid #e2e8f0 !important;
  }

  html[data-theme="light"] .learning-item-card .card[class*="border-l-gray"],
  html[data-theme="light"] .learning-item-card .card[class*="status-not_started"] {
    border-left: 8px solid #64748b !important; /* slate-500 */
    border-right: 3px solid #e2e8f0 !important;
    border-top: 3px solid #e2e8f0 !important;
    border-bottom: 3px solid #e2e8f0 !important;
  }

  /* Icône "Compléter" en mode clair */
  html[data-theme="light"] .learning-item-card button[title="Mark as complete"],
  html[data-theme="light"] .learning-item-card button[title="Mark as incomplete"] {
    background-color: #dcfce7 !important; /* green-100 */
    color: #15803d !important; /* green-700 */
    border: 2px solid #bbf7d0 !important; /* green-200 */
    border-radius: 12px !important;
    min-width: 40px !important;
    min-height: 40px !important;
    padding: 0 !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
  }

  html[data-theme="light"] .learning-item-card button[title="Mark as complete"]:hover,
  html[data-theme="light"] .learning-item-card button[title="Mark as incomplete"]:hover {
    background-color: #bbf7d0 !important; /* green-200 */
  }
  
  /* Icône du bouton "Compléter" */
  html[data-theme="light"] .learning-item-card button[title="Mark as complete"] svg,
  html[data-theme="light"] .learning-item-card button[title="Mark as incomplete"] svg {
    width: 22px !important;
    height: 22px !important;
    color: #15803d !important; /* green-700 */
    stroke-width: 2px !important;
  }
  
  /* Cartes en mode sombre */
  html[data-theme="dark"] .learning-item-card .card {
    border: 3px solid #1e293b !important;
    border-radius: 16px !important;
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.25) !important;
    margin-bottom: 32px !important;
    background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%) !important;
  }
  
  /* Bordures colorées en mode sombre */
  html[data-theme="dark"] .learning-item-card .card[class*="border-l-blue-400"],
  html[data-theme="dark"] .learning-item-card .card[class*="status-in_progress"] {
    border-left: 8px solid #2563eb !important;
    border-right: 3px solid #1e293b !important;
    border-top: 3px solid #1e293b !important;
    border-bottom: 3px solid #1e293b !important;
  }

  html[data-theme="dark"] .learning-item-card .card[class*="border-l-green-400"],
  html[data-theme="dark"] .learning-item-card .card[class*="status-completed"] {
    border-left: 8px solid #059669 !important;
    border-right: 3px solid #1e293b !important;
    border-top: 3px solid #1e293b !important;
    border-bottom: 3px solid #1e293b !important;
  }

  html[data-theme="dark"] .learning-item-card .card[class*="border-l-yellow-400"],
  html[data-theme="dark"] .learning-item-card .card[class*="status-on_hold"] {
    border-left: 8px solid #d97706 !important;
    border-right: 3px solid #1e293b !important;
    border-top: 3px solid #1e293b !important;
    border-bottom: 3px solid #1e293b !important;
  }

  /* Bouton "Compléter" en mode sombre */
  html[data-theme="dark"] .learning-item-card button[title="Mark as complete"],
  html[data-theme="dark"] .learning-item-card button[title="Mark as incomplete"] {
    background-color: rgba(16, 185, 129, 0.2) !important;
    color: #34d399 !important;
    border: 2px solid rgba(16, 185, 129, 0.4) !important;
    border-radius: 12px !important;
    min-width: 40px !important;
    min-height: 40px !important;
    padding: 0 !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
  }

  html[data-theme="dark"] .learning-item-card button[title="Mark as complete"] svg,
  html[data-theme="dark"] .learning-item-card button[title="Mark as incomplete"] svg {
    width: 22px !important;
    height: 22px !important;
    color: #34d399 !important; /* green-400 */
    stroke-width: 2px !important;
  }
  
  /* Sessions dans le mode sombre */
  html[data-theme="dark"] .learning-item-card .border.rounded-xl {
    border: 2px solid rgba(51, 65, 85, 0.8) !important;
    border-radius: 12px !important;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2) !important;
    padding: 16px !important;
    margin-bottom: 16px !important;
    background: #0f172a !important;
  }
  
  html[data-theme="dark"] .learning-item-card .border.rounded-xl[class*="border-l-blue-400"] {
    border-left: 6px solid #2563eb !important;
    background: linear-gradient(135deg, #1e40af 0%, #1e3a8a 100%) !important;
    background-opacity: 0.2 !important;
  }
  
  html[data-theme="dark"] .learning-item-card .border.rounded-xl:has([class*="on_hold"]) {
    border-left: 6px solid #d97706 !important;
    background: linear-gradient(135deg, #92400e 0%, #78350f 100%) !important;
    background-opacity: 0.2 !important;
  }
  
  html[data-theme="dark"] .learning-item-card .border.rounded-xl:has([class*="completed"]) {
    border-left: 6px solid #059669 !important;
    background: linear-gradient(135deg, #065f46 0%, #064e3b 100%) !important;
    background-opacity: 0.2 !important;
  }
}
