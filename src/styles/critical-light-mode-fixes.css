/* Correctifs critiques pour le mode clair sur mobile */
@media (max-width: 768px) {
  /* Fond d'application principal - UNIQUEMENT mode clair */
  html[data-theme="light"]:not([data-theme="dark"]),
  html[data-theme="light"]:not([data-theme="dark"]) body {
    --background: 248 250 252 !important; /* slate-50 */
    background-color: #f8fafc !important;
  }
  
  /* Amélioration de la transition entre modes */
  html, body, .card, [class*="Card"], [class*="-card"] {
    transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
  }

  /* Améliorer la visibilité des cartes d'apprentissage - VERSION RENFORCÉE - UNIQUEMENT mode clair */
  html[data-theme="light"]:not([data-theme="dark"]) .learning-item-card,
  html[data-theme="light"]:not([data-theme="dark"]) [class*="learning-item-card"],
  html[data-theme="light"]:not([data-theme="dark"]) [class*="learning-card"],
  html[data-theme="light"]:not([data-theme="dark"]) .card,
  html[data-theme="light"]:not([data-theme="dark"]) div.card,
  html[data-theme="light"]:not([data-theme="dark"]) div[class*="Card"],
  html[data-theme="light"]:not([data-theme="dark"]) div[class*="card"],
  html[data-theme="light"]:not([data-theme="dark"]) .dark\:bg-gray-800,
  html[data-theme="light"]:not([data-theme="dark"]) .mastered-card,
  html[data-theme="light"]:not([data-theme="dark"]) div.mastered-card {
    background-color: #ffffff !important; /* blanc pur */
    background: #ffffff !important; /* double propriété pour forcer l'override */
    border-color: rgba(0, 0, 0, 0.1) !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08) !important;
    overflow: hidden; /* Pour éviter les fuites de style */
  }

  /* Correction pour les éléments avec des classes dark UNIQUEMENT en mode clair */
  html[data-theme="light"]:not([data-theme="dark"]) .dark\:bg-gray-800,
  html[data-theme="light"]:not([data-theme="dark"]) .dark\:bg-card {
    background-color: #ffffff !important;
    background: #ffffff !important;
  }

  /* PRÉSERVATION DES COULEURS IMPORTANTES DANS LES DEUX MODES */
  /* Ne jamais modifier la couleur des icônes */
  svg, [class*="lucide-"], [class*="icon"] {
    color: currentColor !important;
  }

  /* Préserver les couleurs des badges dans les deux modes */
  [class*="badge"].bg-blue-100, 
  [class*="badge"].bg-green-100, 
  [class*="badge"].bg-yellow-100,
  [class*="badge"].bg-red-100 {
    color: currentColor !important;
  }

  /* Ne pas modifier les couleurs des boutons spécifiques dans les deux modes */
  button.bg-blue-500,
  button.bg-green-500,
  button.bg-red-500,
  button.bg-yellow-500,
  .bg-blue-500,
  .bg-green-500, 
  .bg-red-500,
  .bg-yellow-500 {
    color: #ffffff !important;
  }

  /* Corriger spécifiquement les badges colorés en mode clair */
  html[data-theme="light"]:not([data-theme="dark"]) [class*="bg-blue-100"].text-blue-700,
  html[data-theme="light"]:not([data-theme="dark"]) [class*="bg-green-100"].text-green-700,
  html[data-theme="light"]:not([data-theme="dark"]) [class*="bg-yellow-100"].text-yellow-700,
  html[data-theme="light"]:not([data-theme="dark"]) [class*="bg-red-100"].text-red-700 {
    color: currentColor !important;
  }
  
  /* Corriger spécifiquement les badges en mode sombre */
  html[data-theme="dark"] [class*="badge"] {
    border-color: rgba(255, 255, 255, 0.1) !important;
  }

  /* Sélecteurs renforcés pour les cartes en mode clair */
  html[data-theme="light"] .card,
  html[data-theme="light"] [class*="card"],
  html[data-theme="light"] .learning-item-card,
  html[data-theme="light"] [class*="learning-item-card"],
  html[data-theme="light"] [class*="learning-card"],
  :root:not(.dark) .card,
  :root:not(.dark) [class*="card"],
  :root:not(.dark) .learning-item-card,
  :root:not(.dark) [class*="learning-item-card"],
  :root:not(.dark) [class*="learning-card"] {
    background-color: #ffffff !important;
    border: 1px solid rgba(0, 0, 0, 0.15) !important;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1) !important;
    color: #374151 !important;
  }
  
  /* Titres de cartes */
  html[data-theme="light"] .card h3,
  html[data-theme="light"] [class*="card"] h3,
  html[data-theme="light"] .card h4,
  html[data-theme="light"] [class*="card"] h4,
  html[data-theme="light"] .card [class*="title"],
  html[data-theme="light"] [class*="card"] [class*="title"],
  html[data-theme="light"] .card [class*="heading"],
  html[data-theme="light"] [class*="card"] [class*="heading"],
  :root:not(.dark) .card h3,
  :root:not(.dark) [class*="card"] h3,
  :root:not(.dark) .card h4,
  :root:not(.dark) [class*="card"] h4,
  :root:not(.dark) .card [class*="title"],
  :root:not(.dark) [class*="card"] [class*="title"],
  :root:not(.dark) .card [class*="heading"],
  :root:not(.dark) [class*="card"] [class*="heading"] {
    color: #111827 !important;
    font-weight: 600 !important;
    opacity: 1 !important;
  }
  
  /* Textes et paragraphes */
  html[data-theme="light"] .card p,
  html[data-theme="light"] [class*="card"] p,
  html[data-theme="light"] .card [class*="text"],
  html[data-theme="light"] [class*="card"] [class*="text"],
  html[data-theme="light"] .card [class*="description"],
  html[data-theme="light"] [class*="card"] [class*="description"],
  :root:not(.dark) .card p,
  :root:not(.dark) [class*="card"] p,
  :root:not(.dark) .card [class*="text"],
  :root:not(.dark) [class*="card"] [class*="text"],
  :root:not(.dark) .card [class*="description"],
  :root:not(.dark) [class*="card"] [class*="description"] {
    color: #374151 !important;
    opacity: 1 !important;
    visibility: visible !important;
  }
  
  /* Badges et tags */
  html[data-theme="light"] .card [class*="badge"],
  html[data-theme="light"] [class*="card"] [class*="badge"],
  html[data-theme="light"] .card [class*="tag"],
  html[data-theme="light"] [class*="card"] [class*="tag"],
  :root:not(.dark) .card [class*="badge"],
  :root:not(.dark) [class*="card"] [class*="badge"],
  :root:not(.dark) .card [class*="tag"],
  :root:not(.dark) [class*="card"] [class*="tag"] {
    background-color: #f3f4f6 !important;
    color: #1f2937 !important;
    border: 1px solid #d1d5db !important;
  }
  
  /* Icônes */
  html[data-theme="light"] .card svg,
  html[data-theme="light"] [class*="card"] svg,
  html[data-theme="light"] .card [class*="icon"],
  html[data-theme="light"] [class*="card"] [class*="icon"],
  :root:not(.dark) .card svg,
  :root:not(.dark) [class*="card"] svg,
  :root:not(.dark) .card [class*="icon"],
  :root:not(.dark) [class*="card"] [class*="icon"] {
    color: #4b5563 !important;
    stroke: #4b5563 !important;
    fill: none !important;
  }
  
  /* Sections spécifiques - Completed Today et Active Tasks */
  html[data-theme="light"] [class*="completed-today"],
  html[data-theme="light"] [class*="active-tasks"],
  :root:not(.dark) [class*="completed-today"],
  :root:not(.dark) [class*="active-tasks"] {
    color: #374151 !important;
  }
  
  html[data-theme="light"] [class*="completed-today"] h3,
  html[data-theme="light"] [class*="active-tasks"] h3,
  html[data-theme="light"] [class*="completed-today"] [class*="heading"],
  html[data-theme="light"] [class*="active-tasks"] [class*="heading"],
  :root:not(.dark) [class*="completed-today"] h3,
  :root:not(.dark) [class*="active-tasks"] h3,
  :root:not(.dark) [class*="completed-today"] [class*="heading"],
  :root:not(.dark) [class*="active-tasks"] [class*="heading"] {
    color: #111827 !important;
    font-weight: 600 !important;
  }
  
  html[data-theme="light"] [class*="completed-today"] .card,
  html[data-theme="light"] [class*="active-tasks"] .card,
  :root:not(.dark) [class*="completed-today"] .card,
  :root:not(.dark) [class*="active-tasks"] .card {
    background-color: #ffffff !important;
    border: 1px solid rgba(0, 0, 0, 0.15) !important;
  }

  /* Onglet Items */
  html[data-theme="light"] [id*="items-tab"],
  :root:not(.dark) [id*="items-tab"] {
    color: #374151 !important;
  }
  
  html[data-theme="light"] [id*="items-tab"] .card,
  :root:not(.dark) [id*="items-tab"] .card {
    background-color: #ffffff !important;
    border: 1px solid rgba(0, 0, 0, 0.15) !important;
  }
}

/* FIXATEUR DE MODE SOMBRE - Garantir que le mode sombre fonctionne correctement */
@media (max-width: 768px) {
  html[data-theme="dark"], 
  html[data-theme="dark"] body {
    background-color: #1e293b !important; /* slate-800 */
    color-scheme: dark !important;
  }
  
  /* Assurer les fonds noirs pour le mode sombre */
  html[data-theme="dark"] .card,
  html[data-theme="dark"] [class*="Card"],
  html[data-theme="dark"] [class*="-card"],
  html[data-theme="dark"] [class*="card"] {
    background-color: #1e293b !important; /* slate-800 */
    background: #1e293b !important;
    border-color: rgba(255, 255, 255, 0.1) !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2) !important;
  }
  
  /* Texte en blanc pour le mode sombre */
  html[data-theme="dark"] h1,
  html[data-theme="dark"] h2,
  html[data-theme="dark"] h3,
  html[data-theme="dark"] h4,
  html[data-theme="dark"] h5,
  html[data-theme="dark"] h6 {
    color: #f8fafc !important; /* slate-50 */
  }
  
  html[data-theme="dark"] p:not([class*="text-"]),
  html[data-theme="dark"] span:not([class*="text-"]) {
    color: #e2e8f0 !important; /* slate-200 */
  }
}
