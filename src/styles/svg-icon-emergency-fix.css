/**
 * CORRECTIFS D'URGENCE POUR LES ICÔNES SVG
 * Ces règles extrêmement spécifiques doivent corriger tous les problèmes d'icônes
 * en mode sombre, en ciblant directement les éléments SVG et leurs attributs.
 */

/* RÉINITIALISATION COMPLÈTE DES STYLES POUR TOUTES LES ICÔNES SVG EN MODE SOMBRE */
html[data-theme="dark"] svg,
html[data-theme="dark"] *[data-lucide],
html[data-theme="dark"] *.lucide,
html[data-theme="dark"] svg[class*="lucide-"] {
  fill: none !important;
  stroke: currentColor !important;
  stroke-width: 2px !important;
  stroke-linecap: round !important;
  stroke-linejoin: round !important;
  stroke-opacity: 1 !important;
  stroke-dasharray: none !important;
  stroke-dashoffset: 0 !important;
  vector-effect: non-scaling-stroke !important;
  paint-order: stroke !important;
  visibility: visible !important;
  opacity: 1 !important;
  transform: none !important;
  display: inline-block !important;
}

/* FORCE LE REMPLISSAGE À NONE POUR TOUS LES CHEMINS SVG */
html[data-theme="dark"] svg *,
html[data-theme="dark"] svg path,
html[data-theme="dark"] svg line,
html[data-theme="dark"] svg polyline,
html[data-theme="dark"] svg circle,
html[data-theme="dark"] svg rect,
html[data-theme="dark"] svg polygon {
  fill: none !important;
  fill-opacity: 0 !important;
  stroke: inherit !important;
  stroke-width: inherit !important;
  stroke-linecap: inherit !important;
  stroke-linejoin: inherit !important;
}

/* CORRECTIFS ULTRA-SPÉCIFIQUES POUR LES ICÔNES DANS LES CARTES */
html[data-theme="dark"] .card svg,
html[data-theme="dark"] .learning-item-card svg,
html[data-theme="dark"] .item-wrapper svg,
html[data-theme="dark"] button svg,
html[data-theme="dark"] .badge svg {
  fill: none !important;
  stroke: currentColor !important;
  stroke-width: 2.5px !important;
  transform: scale(1.05) !important; /* Légèrement plus grand pour meilleure visibilité */
}

/* ICÔNES LUCIDE SPÉCIFIQUES - RÈGLES À TRÈS HAUTE PRIORITÉ */
html[data-theme="dark"] svg[data-lucide="Edit"],
html[data-theme="dark"] svg[data-lucide="Save"],
html[data-theme="dark"] svg[data-lucide="Trash2"],
html[data-theme="dark"] svg[data-lucide="Clock"],
html[data-theme="dark"] svg[data-lucide="Check"],
html[data-theme="dark"] svg[data-lucide="X"],
html[data-theme="dark"] svg[data-lucide="Play"],
html[data-theme="dark"] svg[data-lucide="Pause"],
html[data-theme="dark"] svg[data-lucide="Plus"],
html[data-theme="dark"] svg[data-lucide="Link"],
html[data-theme="dark"] svg[data-lucide="ExternalLink"],
html[data-theme="dark"] svg[data-lucide="Download"],
html[data-theme="dark"] svg[data-lucide="Eye"],
html[data-theme="dark"] svg[data-lucide="EyeOff"],
html[data-theme="dark"] svg[data-lucide="Bookmark"],
html[data-theme="dark"] svg[data-lucide="BookmarkCheck"] {
  fill: none !important;
  stroke: currentColor !important;
  stroke-width: 2.5px !important;
  visibility: visible !important;
  display: inline-block !important;
}

/* RÉINITIALISATIONS POUR LES CHEMINS À L'INTÉRIEUR DE CHAQUE ICÔNE */
html[data-theme="dark"] svg[data-lucide="Edit"] *,
html[data-theme="dark"] svg[data-lucide="Save"] *,
html[data-theme="dark"] svg[data-lucide="Trash2"] *,
html[data-theme="dark"] svg[data-lucide="Clock"] *,
html[data-theme="dark"] svg[data-lucide="Check"] *,
html[data-theme="dark"] svg[data-lucide="X"] *,
html[data-theme="dark"] svg[data-lucide="Play"] *,
html[data-theme="dark"] svg[data-lucide="Pause"] *,
html[data-theme="dark"] svg[data-lucide="Plus"] *,
html[data-theme="dark"] svg[data-lucide="Link"] *,
html[data-theme="dark"] svg[data-lucide="ExternalLink"] *,
html[data-theme="dark"] svg[data-lucide="Download"] *,
html[data-theme="dark"] svg[data-lucide="Eye"] *,
html[data-theme="dark"] svg[data-lucide="EyeOff"] *,
html[data-theme="dark"] svg[data-lucide="Bookmark"] *,
html[data-theme="dark"] svg[data-lucide="BookmarkCheck"] * {
  fill: none !important;
  stroke: inherit !important;
}

/* CAS SPÉCIAL POUR L'ICÔNE TROPHY */
html[data-theme="dark"] svg[data-lucide="Trophy"] {
  fill: none !important;
  stroke: #facc15 !important;
  stroke-width: 2.5px !important;
}

html[data-theme="dark"] svg[data-lucide="Trophy"] path {
  fill: none !important;
  stroke: #facc15 !important;
}

/* Exception pour les chemins qui DOIVENT avoir un remplissage */
html[data-theme="dark"] svg[data-lucide="Trophy"] path[fill="currentColor"] {
  fill: #facc15 !important;
  stroke: #facc15 !important;
}

/* COLORATIONS SPÉCIFIQUES POUR LES ICÔNES EN FONCTION DE LA CLASSE DE TEXTE */
html[data-theme="dark"] .text-red-500 svg,
html[data-theme="dark"] .text-red-600 svg,
html[data-theme="dark"] [class*="text-red-"] svg,
html[data-theme="dark"] svg.text-red-500,
html[data-theme="dark"] svg.text-red-600,
html[data-theme="dark"] svg[class*="text-red-"] {
  stroke: #ef4444 !important;
  fill: none !important;
}

html[data-theme="dark"] .text-green-500 svg,
html[data-theme="dark"] .text-green-600 svg,
html[data-theme="dark"] [class*="text-green-"] svg,
html[data-theme="dark"] svg.text-green-500,
html[data-theme="dark"] svg.text-green-600,
html[data-theme="dark"] svg[class*="text-green-"] {
  stroke: #22c55e !important;
  fill: none !important;
}

html[data-theme="dark"] .text-blue-500 svg,
html[data-theme="dark"] .text-blue-600 svg,
html[data-theme="dark"] [class*="text-blue-"] svg,
html[data-theme="dark"] svg.text-blue-500,
html[data-theme="dark"] svg.text-blue-600,
html[data-theme="dark"] svg[class*="text-blue-"] {
  stroke: #3b82f6 !important;
  fill: none !important;
}

html[data-theme="dark"] .text-yellow-500 svg,
html[data-theme="dark"] .text-yellow-600 svg,
html[data-theme="dark"] [class*="text-yellow-"] svg,
html[data-theme="dark"] svg.text-yellow-500,
html[data-theme="dark"] svg.text-yellow-600,
html[data-theme="dark"] svg[class*="text-yellow-"] {
  stroke: #facc15 !important;
  fill: none !important;
}

/* COLORATIONS SPÉCIFIQUES POUR LES BOUTONS AVEC ICÔNES */
html[data-theme="dark"] button.text-red-500 svg,
html[data-theme="dark"] button.text-red-600 svg,
html[data-theme="dark"] button[class*="text-red-"] svg {
  stroke: #ef4444 !important;
  fill: none !important;
}

html[data-theme="dark"] button.text-green-500 svg,
html[data-theme="dark"] button.text-green-600 svg,
html[data-theme="dark"] button[class*="text-green-"] svg {
  stroke: #22c55e !important;
  fill: none !important;
}

html[data-theme="dark"] button.text-blue-500 svg,
html[data-theme="dark"] button.text-blue-600 svg,
html[data-theme="dark"] button[class*="text-blue-"] svg {
  stroke: #3b82f6 !important;
  fill: none !important;
}

html[data-theme="dark"] button.text-yellow-500 svg,
html[data-theme="dark"] button.text-yellow-600 svg,
html[data-theme="dark"] button[class*="text-yellow-"] svg {
  stroke: #facc15 !important;
  fill: none !important;
}

/* STYLES POUR LES ICÔNES DANS LES CARTES SPECIFIQUES */
html[data-theme="dark"] .learning-item-card button svg,
html[data-theme="dark"] .learning-item-card a svg,
html[data-theme="dark"] .item-wrapper button svg,
html[data-theme="dark"] .item-wrapper a svg {
  fill: none !important;
  stroke: currentColor !important;
  stroke-width: 2.5px !important;
}

/* CORRECTION POUR LES ICÔNES DANS LES EN-TÊTES DE CARTE */
html[data-theme="dark"] .card-header svg,
html[data-theme="dark"] .card-title svg,
html[data-theme="dark"] h1 svg, 
html[data-theme="dark"] h2 svg, 
html[data-theme="dark"] h3 svg, 
html[data-theme="dark"] h4 svg {
  fill: none !important;
  stroke: currentColor !important;
  stroke-width: 2.5px !important;
}

/* FORÇAGE POUR LES BOUTONS SPÉCIFIQUES */
html[data-theme="dark"] [title="Edit card"] svg,
html[data-theme="dark"] [title="Save changes"] svg,
html[data-theme="dark"] [title="Delete item"] svg,
html[data-theme="dark"] [title="Mark as complete"] svg,
html[data-theme="dark"] [title="Mark as incomplete"] svg,
html[data-theme="dark"] [title="Export to PDF"] svg,
html[data-theme="dark"] [title="Hide content"] svg,
html[data-theme="dark"] [title="Show content"] svg {
  fill: none !important;
  stroke: currentColor !important;
  stroke-width: 2.5px !important;
  display: inline-block !important;
  visibility: visible !important;
}

/* CORRECTIF POUR LES SVG DÉFECTUEUX DANS LE RENDU */
html[data-theme="dark"] svg:not([data-state="closed"]):not([data-state="open"]):not([role="img"]) {
  fill: none !important;
  stroke: currentColor !important;
  stroke-width: 2.5px !important;
}

/* ANIMATION POUR FORCER LE RENDU DES ICÔNES */
@keyframes forceIconRender {
  0% { opacity: 0.99; }
  100% { opacity: 1; }
}

html[data-theme="dark"] svg {
  animation: forceIconRender 0.01s forwards !important;
}

/* AJOUT DE CONTOURS AUX ICÔNES POUR AMÉLIORER LA VISIBILITÉ */
html[data-theme="dark"] .learning-item-card svg,
html[data-theme="dark"] .item-wrapper svg,
html[data-theme="dark"] .card svg {
  filter: drop-shadow(0 0 1px rgba(255, 255, 255, 0.5)) !important;
}

/* CORRECTIF POUR LES ICÔNES DANS LES BADGES */
html[data-theme="dark"] .badge svg {
  fill: none !important;
  stroke: currentColor !important;
  stroke-width: 2.5px !important;
  width: 16px !important;
  height: 16px !important;
}

/* STYLES UNIVERSELS POUR TOUTES LES PAGES */
/* Ces règles s'appliquent en dehors du mode sombre aussi pour assurer la cohérence */
.lucide, 
[data-lucide], 
svg[class*="lucide-"] {
  fill: none !important;
  stroke: currentColor !important;
  stroke-width: 2px !important;
  stroke-linecap: round !important;
  stroke-linejoin: round !important;
  display: inline-block !important;
}
