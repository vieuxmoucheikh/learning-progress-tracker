/**
 * CORRECTIF ULTIME DE FORÇAGE POUR LE MODE SOMBRE
 * Ce fichier contient des règles CSS avec la plus haute spécificité
 * pour forcer les couleurs correctes en mode sombre.
 */

/* SÉLECTEURS ULTRA-SPÉCIFIQUES POUR LES FONDS BLANCS */
html[data-theme="dark"] body *[class*="bg-white"],
html[data-theme="dark"] body *[class*="bg-gray-50"],
html[data-theme="dark"] body *[class*="bg-gray-100"],
html[data-theme="dark"] body div.bg-white,
html[data-theme="dark"] body div.bg-gray-50,
html[data-theme="dark"] body div.bg-gray-100,
html[data-theme="dark"] body .learning-item-card div.bg-white,
html[data-theme="dark"] body .learning-item-card div.bg-gray-50,
html[data-theme="dark"] body .learning-item-card div.bg-gray-100,
html[data-theme="dark"] body .item-wrapper div.bg-white,
html[data-theme="dark"] body .item-wrapper div.bg-gray-50,
html[data-theme="dark"] body .item-wrapper div.bg-gray-100,
html[data-theme="dark"] body .card div.bg-white,
html[data-theme="dark"] body .card div.bg-gray-50,
html[data-theme="dark"] body .card div.bg-gray-100 {
  background-color: #0f172a !important;
  background: #0f172a !important;
  color: #f8fafc !important;
  border-color: #334155 !important;
}

/* CORRECTIF POUR LES SECTIONS P-4 */
html[data-theme="dark"] body div.p-4.bg-white,
html[data-theme="dark"] body div.p-4.bg-gray-50,
html[data-theme="dark"] body div.p-4.bg-gray-100,
html[data-theme="dark"] body div.mb-4.p-4.bg-white,
html[data-theme="dark"] body div.mb-4.p-4.bg-gray-50,
html[data-theme="dark"] body div.mb-4.p-4.bg-gray-100,
html[data-theme="dark"] body div.learning-item-card div.p-4.bg-white,
html[data-theme="dark"] body div.learning-item-card div.p-4.bg-gray-50,
html[data-theme="dark"] body div.learning-item-card div.p-4.bg-gray-100,
html[data-theme="dark"] body div.learning-item-card div.mb-4.p-4.bg-white,
html[data-theme="dark"] body div.learning-item-card div.mb-4.p-4.bg-gray-50,
html[data-theme="dark"] body div.learning-item-card div.mb-4.p-4.bg-gray-100 {
  background-color: #0f172a !important;
  background: #0f172a !important;
  color: #f8fafc !important;
  border: 1px solid #334155 !important;
  border-radius: 0.5rem !important;
}

/* CORRECTIF SPÉCIFIQUE POUR LES AFFICHAGES DE TEMPS */
html[data-theme="dark"] body [class*="total-time"],
html[data-theme="dark"] body [class*="total-minutes"],
html[data-theme="dark"] body [class*="time-display"],
html[data-theme="dark"] body [class*="time-counter"],
html[data-theme="dark"] body [class*="time-tracker"],
html[data-theme="dark"] body [class*="stats-display"],
html[data-theme="dark"] body div[class*="total-time"],
html[data-theme="dark"] body div[class*="total-minutes"],
html[data-theme="dark"] body div[class*="time-display"],
html[data-theme="dark"] body div[class*="time-counter"],
html[data-theme="dark"] body div[class*="time-tracker"],
html[data-theme="dark"] body div[class*="stats-display"] {
  background-color: #0f172a !important;
  background: #0f172a !important;
  color: #f8fafc !important;
  border-color: #334155 !important;
}

/* CORRECTIF POUR LES TEXTES DANS LES SECTIONS À PROBLÈME */
html[data-theme="dark"] body div.p-4.bg-white *:not(svg):not(svg *),
html[data-theme="dark"] body div.p-4.bg-gray-50 *:not(svg):not(svg *),
html[data-theme="dark"] body div.p-4.bg-gray-100 *:not(svg):not(svg *),
html[data-theme="dark"] body div.mb-4.p-4.bg-white *:not(svg):not(svg *),
html[data-theme="dark"] body div.mb-4.p-4.bg-gray-50 *:not(svg):not(svg *),
html[data-theme="dark"] body div.mb-4.p-4.bg-gray-100 *:not(svg):not(svg *),
html[data-theme="dark"] body [class*="total-time"] *:not(svg):not(svg *),
html[data-theme="dark"] body [class*="total-minutes"] *:not(svg):not(svg *),
html[data-theme="dark"] body [class*="time-counter"] *:not(svg):not(svg *),
html[data-theme="dark"] body [class*="time-tracker"] *:not(svg):not(svg *) {
  color: #f8fafc !important;
}

/* CORRECTIF POUR LES ÉLÉMENTS AVEC DES STYLES INLINE */
html[data-theme="dark"] body [style*="background-color: white"],
html[data-theme="dark"] body [style*="background-color: #ffffff"],
html[data-theme="dark"] body [style*="background-color: #fff"],
html[data-theme="dark"] body [style*="background: white"],
html[data-theme="dark"] body [style*="background: #ffffff"],
html[data-theme="dark"] body [style*="background: #fff"] {
  background-color: #0f172a !important;
  background: #0f172a !important;
  color: #f8fafc !important;
}

/* CORRECTIF DE DERNIÈRE CHANCE - AJOUTE UNE ANIMATION FORCÉE POUR DÉCLENCHER LE RENDU */
@keyframes forceDarkModeRepaint {
  0% { opacity: 0.999; }
  100% { opacity: 1; }
}

html[data-theme="dark"] body [class*="bg-white"],
html[data-theme="dark"] body [class*="bg-gray-50"],
html[data-theme="dark"] body [class*="bg-gray-100"],
html[data-theme="dark"] body [class*="time-"],
html[data-theme="dark"] body [class*="total-"] {
  animation: forceDarkModeRepaint 0.01s forwards !important;
}

/* CORRECTIF POUR LES ICÔNES SVG */
html[data-theme="dark"] body svg,
html[data-theme="dark"] body [data-lucide],
html[data-theme="dark"] body svg path,
html[data-theme="dark"] body svg line,
html[data-theme="dark"] body svg polyline,
html[data-theme="dark"] body svg circle,
html[data-theme="dark"] body svg rect {
  fill: none !important;
  stroke-width: 2.5px !important;
  stroke-linecap: round !important;
  stroke-linejoin: round !important;
  vector-effect: non-scaling-stroke !important;
  filter: drop-shadow(0 0 1px rgba(255, 255, 255, 0.7)) !important;
}

/* ICÔNES COLORÉES SPÉCIFIQUES */
html[data-theme="dark"] body svg.text-blue-500,
html[data-theme="dark"] body svg.text-blue-600,
html[data-theme="dark"] body .text-blue-500 svg,
html[data-theme="dark"] body .text-blue-600 svg,
html[data-theme="dark"] body [class*="text-blue-"] svg {
  stroke: #60a5fa !important; /* blue-400 */
  color: #60a5fa !important;
  fill: none !important;
}

html[data-theme="dark"] body svg.text-green-500,
html[data-theme="dark"] body svg.text-green-600,
html[data-theme="dark"] body .text-green-500 svg,
html[data-theme="dark"] body .text-green-600 svg,
html[data-theme="dark"] body [class*="text-green-"] svg {
  stroke: #4ade80 !important; /* green-400 */
  color: #4ade80 !important;
  fill: none !important;
}

html[data-theme="dark"] body svg.text-red-500,
html[data-theme="dark"] body svg.text-red-600,
html[data-theme="dark"] body .text-red-500 svg,
html[data-theme="dark"] body .text-red-600 svg,
html[data-theme="dark"] body [class*="text-red-"] svg {
  stroke: #f87171 !important; /* red-400 */
  color: #f87171 !important;
  fill: none !important;
}

html[data-theme="dark"] body svg.text-yellow-500,
html[data-theme="dark"] body svg.text-yellow-600,
html[data-theme="dark"] body .text-yellow-500 svg,
html[data-theme="dark"] body .text-yellow-600 svg,
html[data-theme="dark"] body [class*="text-yellow-"] svg {
  stroke: #fbbf24 !important; /* yellow-400 */
  color: #fbbf24 !important;
  fill: none !important;
}

/* CAS SPÉCIAL POUR L'ICÔNE TROPHY */
html[data-theme="dark"] body svg[data-lucide="Trophy"] {
  stroke: #fbbf24 !important; /* yellow-400 */
  stroke-width: 2.5px !important;
}

html[data-theme="dark"] body svg[data-lucide="Trophy"] path[fill="currentColor"] {
  fill: #fbbf24 !important; /* yellow-400 */
}

/* AMÉLIORATIONS POUR LES ICÔNES SUR MOBILE */
@media (max-width: 768px) {
  html[data-theme="dark"] body svg,
  html[data-theme="dark"] body [data-lucide],
  html[data-theme="dark"] body .learning-item-card svg,
  html[data-theme="dark"] body .item-wrapper svg,
  html[data-theme="dark"] body button svg,
  html[data-theme="dark"] body .btn svg {
    stroke-width: 3px !important; /* Encore plus épais sur mobile */
    filter: drop-shadow(0 0 2px rgba(255, 255, 255, 0.7)) !important;
  }
}
